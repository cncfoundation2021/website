// Node.js script to generate all pages from sitemap
const fs = require('fs');
const path = require('path');

// Load sitemap
const sitemap = JSON.parse(fs.readFileSync('config/sitemap.json', 'utf8'));

// Base template
const baseTemplate = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{title}} - CNC Foundation</title>
    <meta name="description" content="{{description}}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="{{cssPath}}">
</head>
<body>
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <div class="page-wrapper">
        <div class="container">
            <!-- Header -->
            <header class="header" role="banner">
                <div class="header-top">
                    <div class="contact-info">
                        <span class="phone">
                            <i class="fas fa-phone" aria-hidden="true"></i>
                            9387102011
                        </span>
                    </div>
                    <div class="header-actions">
                        <div class="language-switcher">
                            <select id="language-select" aria-label="Select language">
                                <option value="en">English</option>
                                <option value="as">Assamese</option>
                            </select>
                        </div>
                        <div class="search-container">
                            <input type="search" id="search-input" placeholder="Search..." aria-label="Search">
                            <button class="search-btn" type="button" aria-label="Search">
                                <i class="fas fa-search" aria-hidden="true"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="logo-section">
                    <div class="logo">
                        <h1>CARE & CURE FOUNDATION</h1>
                        <p class="tagline">Manufacturing Excellence Across Assam</p>
                    </div>
                </div>
            </header>

            <!-- Top Navigation -->
            <nav class="top-navigation" role="navigation" aria-label="Main navigation">
                <div class="nav-container">
                    <div class="nav-links" id="top-nav-links" role="menubar">
                        <!-- Navigation will be generated by JavaScript -->
                    </div>
                </div>
            </nav>

            <!-- Main Content -->
            <main id="main-content" class="main-content">
                <div class="page-header">
                    <h1>{{pageTitle}}</h1>
                    <p class="page-description">{{pageDescription}}</p>
                </div>
                
                <div class="content-section">
                    {{content}}
                </div>
            </main>

            <!-- Footer -->
            <footer class="footer" role="contentinfo">
                <div class="footer-content">
                    <div class="footer-section">
                        <h3>Quick Links</h3>
                        <ul>
                            <li><a href="/info/about-us">About Us</a></li>
                            <li><a href="/info/contact-us">Contact Us</a></li>
                            <li><a href="/info/grievances">Grievances</a></li>
                        </ul>
                    </div>
                    <div class="footer-section">
                        <h3>Services</h3>
                        <ul>
                            <li><a href="/offerings/manufacturing-of-products">Manufacturing</a></li>
                            <li><a href="/offerings/supply-of-products">Supply</a></li>
                            <li><a href="/offerings/services">Services</a></li>
                        </ul>
                    </div>
                    <div class="footer-section">
                        <h3>Contact Info</h3>
                        <p>Phone: 9387102011</p>
                        <p>Email: cncfoundation2021@gmail.com</p>
                    </div>
                </div>
                <div class="footer-bottom">
                    <p>&copy; 2024 CNC Foundation. All rights reserved.</p>
                </div>
            </footer>
        </div>
    </div>

    <!-- Scripts -->
    <script src="{{jsPath}}"></script>
    <script src="{{mainJsPath}}"></script>
</body>
</html>`;

// Content generators
function getManufacturingContent(slug) {
    const products = {
        'sweets': 'Traditional Assamese Sweets',
        'nimkin': 'Crispy Nimkin Snacks',
        'puffed-rice': 'Premium Puffed Rice',
        'flattened-rice': 'Quality Flattened Rice'
    };

    const product = products[slug] || 'Manufactured Products';
    
    return `
        <div class="product-section">
            <h2>${product}</h2>
            <div class="product-grid">
                <div class="product-card">
                    <h3>Product Details</h3>
                    <p>High-quality ${product.toLowerCase()} manufactured using traditional methods and modern technology.</p>
                    <ul>
                        <li>Premium ingredients</li>
                        <li>Hygienic processing</li>
                        <li>Quality assurance</li>
                        <li>Fresh packaging</li>
                    </ul>
                </div>
                <div class="product-card">
                    <h3>Specifications</h3>
                    <ul>
                        <li>Weight: 500g, 1kg, 2kg packs</li>
                        <li>Shelf Life: 6 months</li>
                        <li>Storage: Cool, dry place</li>
                        <li>Certification: FSSAI approved</li>
                    </ul>
                </div>
            </div>
            <div class="cta-section">
                <button class="btn btn-primary">Request Quote</button>
                <button class="btn btn-secondary">View Catalog</button>
            </div>
        </div>
    `;
}

function getServicesContent(slug) {
    const services = {
        'vehicle-services': 'Vehicle Services',
        'manpower-services': 'Manpower Services',
        'event-organizing': 'Event Organizing',
        'catering-services': 'Catering Services',
        'photography': 'Photography Services',
        'videography': 'Videography Services',
        'web-development': 'Web Development',
        'graphic-design': 'Graphic Design',
        'email-marketing': 'Email Marketing',
        'paid-advertizing': 'Paid Advertising',
        'online-apply-services': 'Online Application Services'
    };

    const service = services[slug] || 'Professional Services';
    
    return `
        <div class="service-section">
            <h2>${service}</h2>
            <div class="service-details">
                <div class="service-card">
                    <h3>Service Overview</h3>
                    <p>Professional ${service.toLowerCase()} with experienced team and modern equipment.</p>
                    <ul>
                        <li>Expert professionals</li>
                        <li>Modern equipment</li>
                        <li>Quality assurance</li>
                        <li>Timely delivery</li>
                    </ul>
                </div>
                <div class="service-card">
                    <h3>Pricing</h3>
                    <ul>
                        <li>Competitive rates</li>
                        <li>Package deals available</li>
                        <li>Custom quotes</li>
                        <li>Bulk discounts</li>
                    </ul>
                </div>
            </div>
            <div class="booking-section">
                <h3>Book Service</h3>
                <p>Ready to get started? Contact us for a consultation.</p>
                <button class="btn btn-primary">Book Now</button>
            </div>
        </div>
    `;
}

function getInfoContent(slug) {
    const infoPages = {
        'about-us': {
            title: 'About Us',
            content: `
                <div class="about-section">
                    <h2>About CNC Foundation</h2>
                    <p>CNC Foundation is a leading organization in Assam dedicated to manufacturing excellence, supply chain management, and e-business solutions.</p>
                    
                    <div class="about-grid">
                        <div class="about-card">
                            <h3>Our Mission</h3>
                            <p>To provide quality products and services while contributing to the economic development of Assam.</p>
                        </div>
                        <div class="about-card">
                            <h3>Our Vision</h3>
                            <p>To be the most trusted partner for manufacturing and business solutions in Northeast India.</p>
                        </div>
                    </div>
                    
                    <div class="company-stats">
                        <h3>Company Statistics</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <span class="stat-number">500+</span>
                                <span class="stat-label">Projects Completed</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">50+</span>
                                <span class="stat-label">Distributors</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">24/7</span>
                                <span class="stat-label">Support</span>
                            </div>
                        </div>
                    </div>
                </div>
            `
        },
        'contact-us': {
            title: 'Contact Us',
            content: `
                <div class="contact-section">
                    <h2>Contact Us</h2>
                    <div class="contact-info">
                        <div class="contact-details">
                            <h3>Get in Touch</h3>
                            <div class="contact-item">
                                <i class="fas fa-phone"></i>
                                <span>9387102011</span>
                            </div>
                            <div class="contact-item">
                                <i class="fas fa-envelope"></i>
                                <span>cncfoundation2021@gmail.com</span>
                            </div>
                            <div class="contact-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>Guwahati, Assam, India</span>
                            </div>
                        </div>
                        <div class="contact-form">
                            <h3>Send us a Message</h3>
                            <form>
                                <div class="form-group">
                                    <input type="text" placeholder="Your Name" required>
                                </div>
                                <div class="form-group">
                                    <input type="email" placeholder="Your Email" required>
                                </div>
                                <div class="form-group">
                                    <textarea placeholder="Your Message" rows="4" required></textarea>
                                </div>
                                <button type="submit" class="btn btn-primary">Send Message</button>
                            </form>
                        </div>
                    </div>
                </div>
            `
        }
    };

    const page = infoPages[slug];
    return page ? page.content : `
        <div class="default-section">
            <h2>${slug.replace(/-/g, ' ').toUpperCase()}</h2>
            <p>This page is under construction. Content will be added soon.</p>
            <div class="coming-soon">
                <h3>Coming Soon</h3>
                <p>We are working on adding content for this section. Please check back later.</p>
            </div>
        </div>
    `;
}

function getDefaultContent(slug) {
    return `
        <div class="default-section">
            <h2>${slug.replace(/-/g, ' ').toUpperCase()}</h2>
            <p>This page is under construction. Content will be added soon.</p>
            <div class="coming-soon">
                <h3>Coming Soon</h3>
                <p>We are working on adding content for this section. Please check back later.</p>
            </div>
        </div>
    `;
}

function getPageDataFromRoute(route) {
    if (route.startsWith('/info/')) {
        const slug = route.replace('/info/', '');
        return {
            type: 'info',
            slug: slug,
            title: slug.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase()),
            description: `Information about ${slug.replace(/-/g, ' ')}`
        };
    } else if (route.startsWith('/offerings/')) {
        const pathParts = route.replace('/offerings/', '').split('/');
        const mainSlug = pathParts[0];
        const subSlug = pathParts[1];
        
        const typeMap = {
            'manufacturing-of-products': 'manufacturing',
            'supply-of-products': 'supply',
            'services': 'services',
            'e-bussiness': 'ebusiness',
            'distributors': 'dealers',
            'dealers': 'dealers',
            'service-centre': 'service-centre',
            'authorized-reseller': 'authorized-reseller',
            'product-marketing': 'dealers',
            'construction-repairing': 'construction-repairing',
            'donation': 'donation'
        };
        
        return {
            type: typeMap[mainSlug] || 'default',
            slug: subSlug || mainSlug,
            title: (subSlug || mainSlug).replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase()),
            description: `Information about ${(subSlug || mainSlug).replace(/-/g, ' ')}`
        };
    }
    
    return {
        type: 'default',
        slug: route.replace('/', ''),
        title: 'Page',
        description: 'Page description'
    };
}

function getContent(type, slug) {
    switch (type) {
        case 'manufacturing':
            return getManufacturingContent(slug);
        case 'services':
            return getServicesContent(slug);
        case 'info':
            return getInfoContent(slug);
        default:
            return getDefaultContent(slug);
    }
}

function generatePage(route) {
    const pageData = getPageDataFromRoute(route);
    const content = getContent(pageData.type, pageData.slug);
    
    // Calculate relative paths
    const depth = route.split('/').length - 2; // -2 for the leading slash and the route itself
    const cssPath = '../'.repeat(depth) + 'styles/main.css';
    const jsPath = '../'.repeat(depth) + 'lib/menu.js';
    const mainJsPath = '../'.repeat(depth) + 'scripts/main.js';
    
    return baseTemplate
        .replace(/\{\{title\}\}/g, pageData.title)
        .replace(/\{\{description\}\}/g, pageData.description)
        .replace(/\{\{pageTitle\}\}/g, pageData.title)
        .replace(/\{\{pageDescription\}\}/g, pageData.description)
        .replace(/\{\{content\}\}/g, content)
        .replace(/\{\{cssPath\}\}/g, cssPath)
        .replace(/\{\{jsPath\}\}/g, jsPath)
        .replace(/\{\{mainJsPath\}\}/g, mainJsPath);
}

// Generate all pages
const routes = sitemap.routes || [];

console.log('Generating pages...');
console.log('Routes found:', routes.length);

routes.forEach(route => {
    if (route === '/') return; // Skip homepage
    
    const html = generatePage(route);
    const filePath = '.' + route + '.html';
    const dir = path.dirname(filePath);
    
    // Create directory if it doesn't exist
    if (!fs.existsSync(dir)) {
        fs.mkdirSync(dir, { recursive: true });
    }
    
    // Write file
    fs.writeFileSync(filePath, html);
    console.log(`Generated: ${filePath}`);
});

console.log('All pages generated successfully!');
